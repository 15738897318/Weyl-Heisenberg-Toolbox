%% Weyl-Heisenberg Bases Toolbox
% Function "gaborreal.m"
%% Описание:
% Функция формирования квадратной вещественной матрицы базиса Габора.
%% Примечание:
% Данный базис не является ортогональным.
%
%% Входные данные:
% M - количество сдвигов по частоте,
% L - количество сдвигов по времени,
% a - параметр базиса,
% sigma - среднеквадратическое отклонение.
%
%% Выходные данные:
% U - квадратная вещественная матрица базиса Габора
% Вейля-Гейзенберга [2N, 2N].
function [ U ] = gaborreal( M, L, a, sigma )
% Формирование комплексной прямоугольной матрицы базиса:
G = gabor(M, L, a, sigma);

% Формирование квадратной вещественной матрицы по формуле:
%             U = | real(Gr)  real(Gi)| = | real(G) |
%                 | imag(Gr)  imag(Gi)|   | imag(G) |               (1)
% где G = |Gr Gi| - прямоугольная комплексная матрица В-Г.
U  = [real(G); imag(G)];
end